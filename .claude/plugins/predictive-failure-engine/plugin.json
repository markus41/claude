{
  "$schema": "../../core/schemas/plugin.schema.json",
  "name": "predictive-failure-engine",
  "displayName": "Predictive Failure Engine",
  "callsign": "Cassandra",
  "faction": "Forerunner",
  "version": "1.0.0",
  "description": "Cassandra - The Oracle of Inevitable Fates. Revolutionary AI that predicts bugs and failures BEFORE they happen using pattern recognition, code smell analysis, historical failure correlation, and probabilistic modeling. Analyzes code changes to forecast potential issues with confidence scores and mitigation recommendations.",
  "author": {
    "name": "The Lobbi",
    "email": "developers@thelobbi.io"
  },
  "license": "MIT",
  "repository": "https://github.com/Lobbi-Docs/claude",
  "categories": ["ai", "prediction", "quality", "prevention"],
  "keywords": [
    "prediction", "failure-prediction", "bug-prediction", "preventive",
    "machine-learning", "pattern-recognition", "code-smell", "risk-assessment",
    "probabilistic", "early-warning", "defect-prediction", "hotspot-detection",
    "change-risk", "historical-analysis", "trend-detection"
  ],

  "provides": {
    "commands": 14,
    "agents": 11,
    "skills": 7,
    "hooks": 5,
    "predictionModels": 8
  },

  "integrations": {
    "jira-orchestrator": {
      "description": "Links predictions to issues, creates preventive tickets",
      "capabilities": ["create-prevention-tickets", "risk-labeling"],
      "bidirectional": true
    },
    "code-knowledge-graph": {
      "description": "Uses graph for impact and relationship analysis",
      "capabilities": ["dependency-risk", "impact-scoring"],
      "required": true
    },
    "testing-orchestrator": {
      "description": "Recommends targeted tests for high-risk code",
      "capabilities": ["test-recommendations", "risk-based-testing"],
      "enhances": true
    },
    "cognitive-code-reasoner": {
      "description": "Deep analysis of predicted issues",
      "capabilities": ["root-cause-hypothesis"],
      "onHighRisk": true
    }
  },

  "predictionModels": {
    "change-risk": {
      "name": "Change Risk Prediction",
      "description": "Predicts failure probability based on change characteristics",
      "features": [
        "lines-changed",
        "files-changed",
        "complexity-delta",
        "author-experience",
        "time-of-day",
        "day-of-week",
        "proximity-to-deadline",
        "test-coverage-delta"
      ],
      "output": "failure-probability",
      "accuracy": 0.78
    },
    "code-smell-evolution": {
      "name": "Code Smell Evolution",
      "description": "Predicts when code smells will become bugs",
      "smellTypes": [
        "long-method",
        "god-class",
        "feature-envy",
        "data-clumps",
        "primitive-obsession",
        "shotgun-surgery"
      ],
      "timeHorizon": "3-6 months",
      "accuracy": 0.72
    },
    "hotspot-prediction": {
      "name": "Hotspot Prediction",
      "description": "Identifies future bug hotspots",
      "signals": [
        "change-frequency",
        "bug-history",
        "complexity",
        "author-count",
        "age"
      ],
      "output": "hotspot-probability-map",
      "accuracy": 0.82
    },
    "dependency-failure": {
      "name": "Dependency Failure Prediction",
      "description": "Predicts issues from dependency updates",
      "factors": [
        "breaking-change-likelihood",
        "version-delta",
        "dependency-health",
        "usage-patterns"
      ],
      "accuracy": 0.75
    },
    "performance-regression": {
      "name": "Performance Regression Prediction",
      "description": "Predicts performance regressions from code changes",
      "indicators": [
        "loop-complexity-increase",
        "memory-allocation-patterns",
        "database-query-changes",
        "api-call-additions"
      ],
      "accuracy": 0.70
    },
    "security-vulnerability": {
      "name": "Security Vulnerability Prediction",
      "description": "Predicts potential security issues",
      "patterns": [
        "input-handling",
        "authentication-flow",
        "data-exposure",
        "injection-vectors"
      ],
      "accuracy": 0.80
    },
    "concurrency-issues": {
      "name": "Concurrency Issue Prediction",
      "description": "Predicts race conditions and deadlocks",
      "signals": [
        "shared-state-access",
        "lock-patterns",
        "async-chains",
        "resource-ordering"
      ],
      "accuracy": 0.68
    },
    "integration-failure": {
      "name": "Integration Failure Prediction",
      "description": "Predicts integration issues between components",
      "factors": [
        "api-contract-changes",
        "data-format-drift",
        "timing-dependencies",
        "version-mismatches"
      ],
      "accuracy": 0.73
    }
  },

  "riskLevels": {
    "critical": {
      "threshold": 0.9,
      "color": "red",
      "action": "block-merge",
      "notification": "immediate"
    },
    "high": {
      "threshold": 0.7,
      "color": "orange",
      "action": "require-review",
      "notification": "slack"
    },
    "medium": {
      "threshold": 0.5,
      "color": "yellow",
      "action": "recommend-tests",
      "notification": "pr-comment"
    },
    "low": {
      "threshold": 0.3,
      "color": "green",
      "action": "log",
      "notification": "none"
    }
  },

  "commands": {
    "predict:analyze": "commands/analyze.md",
    "predict:change": "commands/change.md",
    "predict:hotspots": "commands/hotspots.md",
    "predict:dependencies": "commands/dependencies.md",
    "predict:security": "commands/security.md",
    "predict:performance": "commands/performance.md",
    "predict:concurrency": "commands/concurrency.md",
    "predict:report": "commands/report.md",
    "predict:history": "commands/history.md",
    "predict:accuracy": "commands/accuracy.md",
    "predict:learn": "commands/learn.md",
    "predict:configure": "commands/configure.md",
    "predict:explain": "commands/explain.md",
    "predict:status": "commands/status.md"
  },

  "agents": {
    "prediction-orchestrator-agent": {
      "path": "agents/prediction-orchestrator-agent.md",
      "model": "sonnet",
      "description": "Master orchestrator for all prediction models",
      "triggers": ["predict", "what might break", "risk analysis"]
    },
    "change-risk-agent": {
      "path": "agents/change-risk-agent.md",
      "model": "sonnet",
      "description": "Analyzes change risk for commits and PRs",
      "triggers": ["change risk", "commit risk", "pr risk"]
    },
    "hotspot-detector-agent": {
      "path": "agents/hotspot-detector-agent.md",
      "model": "sonnet",
      "description": "Identifies and predicts bug hotspots",
      "triggers": ["hotspot", "bug prone", "problem areas"]
    },
    "code-smell-agent": {
      "path": "agents/code-smell-agent.md",
      "model": "sonnet",
      "description": "Detects code smells likely to cause bugs",
      "triggers": ["code smell", "technical debt", "maintainability"]
    },
    "dependency-risk-agent": {
      "path": "agents/dependency-risk-agent.md",
      "model": "haiku",
      "description": "Assesses risk from dependency changes",
      "triggers": ["dependency risk", "upgrade risk", "npm update risk"]
    },
    "performance-predictor-agent": {
      "path": "agents/performance-predictor-agent.md",
      "model": "sonnet",
      "description": "Predicts performance regressions",
      "triggers": ["performance risk", "slow code", "regression risk"]
    },
    "security-predictor-agent": {
      "path": "agents/security-predictor-agent.md",
      "model": "sonnet",
      "description": "Predicts security vulnerabilities",
      "triggers": ["security risk", "vulnerability", "exploit risk"]
    },
    "concurrency-predictor-agent": {
      "path": "agents/concurrency-predictor-agent.md",
      "model": "opus",
      "description": "Predicts race conditions and deadlocks",
      "triggers": ["race condition", "deadlock", "concurrency risk"]
    },
    "mitigation-agent": {
      "path": "agents/mitigation-agent.md",
      "model": "sonnet",
      "description": "Generates mitigation recommendations",
      "triggers": ["mitigate", "prevent", "how to fix risk"]
    },
    "learning-agent": {
      "path": "agents/learning-agent.md",
      "model": "haiku",
      "description": "Learns from prediction outcomes to improve accuracy",
      "triggers": ["learn", "improve prediction", "update model"]
    },
    "explanation-agent": {
      "path": "agents/explanation-agent.md",
      "model": "sonnet",
      "description": "Explains predictions in understandable terms",
      "triggers": ["explain risk", "why predicted", "understand risk"]
    }
  },

  "skills": {
    "change-analysis": {
      "path": "skills/change-analysis.md",
      "description": "Analyzing code changes for risk signals",
      "triggers": ["change", "diff", "commit analysis"]
    },
    "pattern-recognition": {
      "path": "skills/pattern-recognition.md",
      "description": "Recognizing bug-prone patterns",
      "triggers": ["pattern", "recognize", "smell"]
    },
    "historical-correlation": {
      "path": "skills/historical-correlation.md",
      "description": "Correlating with historical failures",
      "triggers": ["history", "past bugs", "correlation"]
    },
    "probabilistic-modeling": {
      "path": "skills/probabilistic-modeling.md",
      "description": "Probabilistic failure modeling",
      "triggers": ["probability", "likelihood", "confidence"]
    },
    "mitigation-strategies": {
      "path": "skills/mitigation-strategies.md",
      "description": "Generating mitigation recommendations",
      "triggers": ["mitigate", "prevent", "fix"]
    },
    "model-calibration": {
      "path": "skills/model-calibration.md",
      "description": "Calibrating prediction models",
      "triggers": ["calibrate", "accuracy", "improve"]
    },
    "risk-communication": {
      "path": "skills/risk-communication.md",
      "description": "Communicating risk effectively",
      "triggers": ["explain", "communicate", "report risk"]
    }
  },

  "hooks": {
    "prePR": {
      "script": "hooks/scripts/pr-risk-analysis.sh",
      "description": "Analyzes PR risk before creation"
    },
    "preCommit": {
      "script": "hooks/scripts/commit-risk-check.sh",
      "description": "Quick risk check before commit"
    },
    "preMerge": {
      "script": "hooks/scripts/merge-gate.sh",
      "description": "Gates merge on high-risk predictions"
    },
    "postIncident": {
      "script": "hooks/scripts/learn-from-incident.sh",
      "description": "Learns from incidents to improve predictions"
    },
    "dailyAnalysis": {
      "script": "hooks/scripts/daily-hotspot-scan.sh",
      "description": "Daily scan for emerging hotspots"
    }
  },

  "patternLibrary": {
    "path": "pattern-library/",
    "categories": [
      "null-pointer-patterns.json",
      "resource-leak-patterns.json",
      "concurrency-patterns.json",
      "security-patterns.json",
      "performance-patterns.json",
      "integration-patterns.json"
    ]
  },

  "permissions": {
    "filesystem": [
      { "path": "**/*", "access": "read" },
      { "path": ".claude/predictions/**", "access": "readwrite" }
    ],
    "tools": ["Bash", "Read", "Grep", "Glob", "Task"],
    "mcpServers": ["github"]
  },

  "configuration": {
    "schema": {
      "type": "object",
      "properties": {
        "enabledModels": {
          "type": "array",
          "items": { "type": "string" },
          "default": ["change-risk", "hotspot-prediction", "security-vulnerability"]
        },
        "blockOnCritical": {
          "type": "boolean",
          "default": true
        },
        "learningEnabled": {
          "type": "boolean",
          "default": true
        },
        "notificationThreshold": {
          "type": "string",
          "enum": ["critical", "high", "medium", "low"],
          "default": "high"
        },
        "historyWindowDays": {
          "type": "number",
          "default": 365,
          "description": "Days of history to analyze"
        },
        "confidenceThreshold": {
          "type": "number",
          "default": 0.7,
          "minimum": 0.5,
          "maximum": 1.0
        }
      }
    }
  },

  "activation": {
    "auto": true,
    "priority": 925,
    "conditions": {
      "keywords": [
        "predict", "risk", "might break", "could fail", "bug prone",
        "hotspot", "likely to fail", "dangerous change"
      ]
    }
  }
}
