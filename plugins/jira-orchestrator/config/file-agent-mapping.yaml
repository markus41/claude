# File-Agent Mapping Configuration
# Optimized: Consolidated patterns, reduced redundancy
version: "1.0.0"
description: "Maps file patterns to agent domains and recommended specialists"

# ============================================================================
# DOMAIN DEFINITIONS
# ============================================================================
domains:
  frontend:
    description: "Frontend/UI development with React, Next.js, components"
    priority: 100
    keywords: [react, component, ui, tsx, jsx, css, styled, tailwind, nextjs, page, layout, theme]
    primary_agents: [react-component-architect, frontend-specialist, accessibility-expert, ui-ux-specialist]
    file_patterns: ["*.tsx", "*.jsx", "*.css", "*.scss", "*.less", "*.styled.ts", "*.styled.tsx", "components/**/*", "pages/**/*", "app/**/*.(tsx|jsx)", "src/(ui|components|pages)/**/*", "styles/**/*", "public/**/*.css"]

  backend:
    description: "Backend services, API endpoints, business logic"
    priority: 90
    keywords: [api, rest, endpoint, service, controller, middleware, server, route, handler]
    primary_agents: [api-integration-specialist, code-architect, backend-specialist, microservices-architect]
    file_patterns: ["api/**/*.(ts|js)", "server/**/*.(ts|js)", "services/**/*.(ts|js)", "src/(api|server|services)/**/*", "(controllers|middleware|routes|handlers)/**/*"]

  database:
    description: "Database schemas, migrations, ORM configurations"
    priority: 95
    keywords: [prisma, schema, migration, sql, database, db, model, entity, query]
    primary_agents: [prisma-specialist, database-specialist, data-architect]
    file_patterns: ["*.prisma", "prisma/**/*", "migrations/**/*", "*.sql", "src/(db|database)/**/*", "(database|db|schema)/**/*", "(models|entities)/**/*.ts"]

  graphql:
    description: "GraphQL schemas, resolvers, queries, mutations"
    priority: 85
    keywords: [graphql, resolver, query, mutation, subscription, gql, schema]
    primary_agents: [graphql-specialist, api-integration-specialist]
    file_patterns: ["*.(graphql|gql)", "graphql/**/*", "src/graphql/**/*", "resolvers/**/*", "schema/**/*.(graphql|gql)"]

  testing:
    description: "Unit tests, integration tests, E2E tests, test utilities"
    priority: 80
    keywords: [test, spec, jest, vitest, playwright, cypress, e2e, integration, unit, mock, fixture]
    primary_agents: [test-writer-fixer, coverage-analyzer, e2e-test-specialist, test-architect]
    file_patterns: ["*.(test|spec).(ts|tsx|js|jsx)", "__tests__/**/*", "(tests|test|e2e|cypress|playwright)/**/*", "*.(e2e|integration).ts"]

  devops:
    description: "Docker, Kubernetes, Helm, CI/CD, deployment"
    priority: 90
    keywords: [docker, kubernetes, k8s, helm, deployment, ci, cd, pipeline, container, orchestration]
    primary_agents: [k8s-architect, helm-chart-developer, docker-specialist, cicd-specialist]
    file_patterns: ["Dockerfile*", "docker-compose*.y(a)?ml", "(k8s|kubernetes|helm|deployment)/**/*", ".github/workflows/**/*", ".gitlab-ci.yml", "Jenkinsfile", "*.dockerfile", "(.harness|harness)/**/*", "harness.yaml", "pipeline.yaml"]

  auth:
    description: "Keycloak, OAuth, authentication, authorization, identity"
    priority: 85
    keywords: [keycloak, oauth, authentication, authorization, auth, jwt, token, identity, rbac, permissions]
    primary_agents: [keycloak-identity-specialist, security-specialist, auth-architect]
    file_patterns: ["(keycloak|auth|authentication|authorization|identity|oauth)/**/*", "src/auth/**/*"]

  documentation:
    description: "Documentation, README files, guides, ADRs"
    priority: 70
    keywords: [docs, readme, documentation, guide, adr, markdown, wiki]
    primary_agents: [codebase-documenter, technical-writer, adr-specialist]
    file_patterns: ["*.(md|mdx)", "(docs|documentation)/**/*", "README*", "CHANGELOG*", "CONTRIBUTING*", "(adr|decisions)/**/*"]

  ai:
    description: "AI/ML models, embeddings, training, inference"
    priority: 85
    keywords: [ai, ml, model, embedding, training, inference, neural, tensorflow, pytorch, anthropic, openai]
    primary_agents: [ai-engineer, ml-specialist, llm-integration-specialist]
    file_patterns: ["ai/**/*.(py|ts)", "ml/**/*", "models/**/*.py", "(training|inference|embeddings)/**/*", "src/(ai|ml)/**/*"]

  infrastructure:
    description: "Terraform, Ansible, cloud infrastructure, IaC"
    priority: 88
    keywords: [terraform, ansible, infra, infrastructure, iac, provisioning, cloud, aws, gcp, azure]
    primary_agents: [terraform-specialist, ansible-specialist, cloud-architect]
    file_patterns: ["terraform/**/*.(tf|tfvars)", "infra/**/*.tf", "infrastructure/**/*", "*.(tf|tfvars)", "ansible/**/*", "playbooks/**/*", "*.(yml|yaml)"]

  caching:
    description: "Redis, caching strategies, session management"
    priority: 75
    keywords: [redis, cache, session, memcache, caching, ttl]
    primary_agents: [redis-specialist, performance-optimizer]
    file_patterns: ["(redis|cache)/**/*", "src/(cache|redis)/**/*"]

  messaging:
    description: "Kafka, message queues, event streaming, pub/sub"
    priority: 80
    keywords: [kafka, message, event, queue, pubsub, streaming, consumer, producer]
    primary_agents: [kafka-specialist, event-driven-architect]
    file_patterns: ["(kafka|messaging|events)/**/*", "src/(kafka|messaging|events)/**/*"]

  config:
    description: "Configuration files, settings, environment"
    priority: 60
    keywords: [config, configuration, settings, env, environment]
    primary_agents: [code-architect, devops-specialist]
    file_patterns: ["*.config.(ts|js|json)", "config/**/*", "configuration/**/*", ".env*", "*.env", "(tsconfig|package|next.config|vite.config|jest.config).*"]

  monitoring:
    description: "Logging, metrics, tracing, observability"
    priority: 75
    keywords: [monitoring, observability, logging, metrics, tracing, prometheus, grafana, datadog]
    primary_agents: [observability-specialist, performance-optimizer]
    file_patterns: ["(monitoring|observability|metrics|tracing|logging)/**/*"]

# ============================================================================
# PHASE-SPECIFIC AGENT MAPPINGS
# ============================================================================
phase_mappings:
  EXPLORE:
    description: "Analysis and discovery phase"
    all_domains: [analyze-codebase, requirements-analyzer, dependency-mapper]
    domain_overrides:
      database: [schema-analyzer]
      frontend: [component-tree-analyzer]
      backend: [api-endpoint-mapper]

  PLAN:
    description: "Architecture and design phase"
    all_domains: [code-architect, design-pattern-specialist]
    domain_overrides:
      devops: [infrastructure-planner]
      database: [data-modeling-specialist]

  CODE:
    description: "Implementation phase (use domain primary agents)"
    all_domains: []

  TEST:
    description: "Testing and validation phase"
    override_primary: true
    all_domains: [test-writer-fixer, coverage-analyzer, qa-specialist]
    domain_overrides:
      frontend: [e2e-test-specialist, accessibility-tester]
      backend: [api-test-specialist, integration-test-specialist]

  FIX:
    description: "Bug fixing and debugging phase"
    all_domains: [bug-detective, error-analyzer, debugger-specialist]
    domain_overrides:
      frontend: [react-debugger]
      backend: [api-debugger]
      database: [query-optimizer]

  DOCUMENT:
    description: "Documentation phase"
    override_primary: true
    all_domains: [codebase-documenter, technical-writer, api-documentation-specialist]
    domain_overrides:
      database: [schema-documenter]
      devops: [infrastructure-documenter]

  REVIEW:
    description: "Code review and quality assurance phase"
    all_domains: [code-reviewer, security-auditor, best-practices-enforcer]
    domain_overrides:
      frontend: [accessibility-reviewer]
      backend: [api-security-reviewer]
      database: [schema-reviewer]

# ============================================================================
# EXTENSION SHORTCUTS
# ============================================================================
extension_shortcuts:
  ".tsx": frontend
  ".jsx": frontend
  ".css": frontend
  ".scss": frontend
  ".less": frontend
  ".sass": frontend
  ".styled.ts": frontend
  ".styled.tsx": frontend
  ".ts": backend
  ".js": backend
  ".prisma": database
  ".sql": database
  ".graphql": graphql
  ".gql": graphql
  ".test.ts": testing
  ".test.tsx": testing
  ".test.js": testing
  ".test.jsx": testing
  ".spec.ts": testing
  ".spec.tsx": testing
  ".spec.js": testing
  ".spec.jsx": testing
  ".e2e.ts": testing
  ".e2e.js": testing
  ".integration.ts": testing
  ".md": documentation
  ".mdx": documentation
  ".py": ai
  ".ipynb": ai
  ".tf": infrastructure
  ".tfvars": infrastructure
  "Dockerfile": devops
  ".dockerfile": devops
  ".config.ts": config
  ".config.js": config
  ".config.json": config
  ".env": config

# ============================================================================
# JIRA LABEL MAPPINGS
# ============================================================================
jira_label_mappings:
  frontend: [frontend, react, ui, component, nextjs, page, layout, styling, css, tailwind]
  backend: [backend, api, server, service, endpoint, rest, controller, middleware]
  database: [database, db, prisma, schema, migration, sql, model, entity]
  graphql: [graphql, gql, resolver, query, mutation]
  testing: [testing, test, qa, e2e, integration, unit-test, coverage]
  devops: [devops, infrastructure, deployment, k8s, kubernetes, docker, helm, ci, cd, pipeline]
  auth: [auth, authentication, authorization, keycloak, oauth, security, jwt, permissions]
  documentation: [documentation, docs, readme, guide, adr]
  ai: [ai, ml, machine-learning, model, embedding, llm, anthropic]
  infrastructure: [infrastructure, iac, terraform, ansible, cloud, aws, gcp, azure]
  caching: [cache, caching, redis, session, performance]
  messaging: [kafka, messaging, event, queue, pubsub, streaming]
  monitoring: [monitoring, observability, logging, metrics, tracing, prometheus]

# ============================================================================
# DIRECTORY HINTS
# ============================================================================
directory_hints:
  frontend: [components, pages, app, ui, views, layouts, styles]
  backend: [api, server, services, controllers, middleware, routes, handlers]
  database: [prisma, migrations, db, database, models, entities, schema]
  testing: [tests, test, __tests__, e2e, cypress, playwright]
  devops: [k8s, kubernetes, helm, deployment, docker, .harness, harness]
  infrastructure: [terraform, infra, infrastructure, ansible]
  documentation: [docs, documentation, adr, decisions]

# ============================================================================
# SCORING & FALLBACK
# ============================================================================
scoring:
  extension_match: 40
  pattern_match: 35
  directory_match: 15
  keyword_match: 10
  minimum_score: 30
  max_domains_per_file: 2

fallback:
  default_agents: [code-architect, analyze-codebase]
  default_domain: "backend"
  require_manual_review: true
