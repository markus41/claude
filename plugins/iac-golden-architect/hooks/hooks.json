{
  "tf-pre-apply": {
    "event": "Bash",
    "description": "Security and compliance validation before Terraform apply operations",
    "pattern": "terraform\\s+apply",
    "type": "prompt",
    "timeout": 120000,
    "blocking": true,
    "prompt": "# Terraform Apply Security Validation\n\nBefore executing `terraform apply`, perform security and compliance checks:\n\n## 1. Security Scanning\n\nRun security scanners:\n- tfsec for Terraform security\n- checkov for policy-as-code\n- terrascan for compliance\n\n## 2. Compliance Validation\n\nVerify SOC2 compliance:\n- Required tags: Environment, Owner, CostCenter, DataClassification\n- Encryption at rest enabled\n- Encryption in transit enforced\n- VPC Flow Logs enabled\n- No public access to databases\n\n## 3. Validation Rules\n\n**BLOCK if**: CRITICAL security issues, hardcoded secrets, missing compliance tags, public database access, unencrypted data stores\n\n**WARN if**: MEDIUM security issues, non-standard naming conventions"
  },
  "tf-format-check": {
    "event": "Bash",
    "description": "Ensure Terraform files are properly formatted before git commit",
    "pattern": "git\\s+commit.*\\.tf",
    "type": "command",
    "timeout": 30000,
    "blocking": true,
    "command": "terraform fmt -check -recursive"
  }
}
